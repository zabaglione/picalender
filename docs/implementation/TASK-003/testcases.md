# TASK-003: ログシステム - テストケース

## テストケース一覧

### 1. 基本機能テスト

#### TC-001: LogManagerの初期化
- **前提条件**: ConfigManagerが初期化済み
- **実行**: LogManagerを初期化
- **期待結果**: エラーなく初期化される
- **検証項目**:
  - LogManagerインスタンスが作成される
  - デフォルトログレベルが設定される

#### TC-002: ロガーの取得
- **前提条件**: LogManagerが初期化済み
- **実行**: `get_logger('test_module')`を呼び出し
- **期待結果**: 指定された名前のロガーが取得できる
- **検証項目**:
  - logging.Loggerインスタンスが返される
  - ロガー名が正しく設定される

#### TC-003: ログレベルの設定
- **前提条件**: LogManagerが初期化済み
- **実行**: `set_level('DEBUG')`を呼び出し
- **期待結果**: ログレベルがDEBUGに変更される
- **検証項目**:
  - DEBUGレベルのログが出力される
  - INFOレベル以上のログも出力される

### 2. レベル別出力テスト

#### TC-004: DEBUGレベルのログ出力
- **前提条件**: ログレベルがDEBUG
- **実行**: logger.debug()でメッセージ出力
- **期待結果**: DEBUGログが出力される
- **検証項目**: ログ出力にDEBUGメッセージが含まれる

#### TC-005: INFOレベルのログ出力
- **前提条件**: ログレベルがINFO
- **実行**: logger.info()でメッセージ出力
- **期待結果**: INFOログが出力される
- **検証項目**: 
  - INFOメッセージが出力される
  - DEBUGメッセージは出力されない

#### TC-006: ERRORレベルのログ出力
- **前提条件**: ログレベルがINFO
- **実行**: logger.error()でメッセージ出力
- **期待結果**: ERRORログが出力される
- **検証項目**: ERRORメッセージが出力される

### 3. フォーマットテスト

#### TC-007: タイムスタンプ付きログ
- **前提条件**: デフォルトフォーマット設定
- **実行**: ログを出力
- **期待結果**: タイムスタンプが含まれる
- **検証項目**:
  - 日時が正しい形式で含まれる
  - レベル名が含まれる
  - モジュール名が含まれる

#### TC-008: カスタムフォーマット
- **前提条件**: カスタムフォーマット文字列を設定
- **実行**: ログを出力
- **期待結果**: カスタムフォーマットで出力される
- **検証項目**: 指定したフォーマットに従う

### 4. 出力先テスト

#### TC-009: コンソール出力
- **前提条件**: console出力が有効
- **実行**: ログを出力
- **期待結果**: 標準出力/エラー出力に表示
- **検証項目**:
  - stdout/stderrをキャプチャして確認
  - レベルに応じた出力先の切り替え

#### TC-010: ファイル出力
- **前提条件**: file出力が有効
- **実行**: ログを出力
- **期待結果**: ファイルに書き込まれる
- **検証項目**:
  - 指定されたファイルが作成される
  - ログメッセージがファイルに記録される

#### TC-011: 複数出力先への同時出力
- **前提条件**: console、file両方が有効
- **実行**: ログを出力
- **期待結果**: 両方に出力される
- **検証項目**:
  - コンソールとファイル両方で確認できる

### 5. モジュール別制御テスト

#### TC-012: モジュール別ログレベル設定
- **前提条件**: 
  - グローバル: INFO
  - weatherモジュール: DEBUG
- **実行**: 各モジュールでログ出力
- **期待結果**: モジュール別にレベルが適用される
- **検証項目**:
  - weatherはDEBUGログが出る
  - 他のモジュールはINFO以上のみ

#### TC-013: 動的なレベル変更
- **前提条件**: 実行中のLogManager
- **実行**: 特定モジュールのレベルを変更
- **期待結果**: 即座に反映される
- **検証項目**: 変更後のログ出力が新レベルに従う

### 6. ファイルローテーションテスト

#### TC-014: サイズベースのローテーション
- **前提条件**: rotate_size_mb=1（1MB）
- **実行**: 1MB以上のログを出力
- **期待結果**: 新しいファイルが作成される
- **検証項目**:
  - 元のファイルがリネームされる
  - 新しいファイルに書き込みが継続される

#### TC-015: 古いファイルの削除
- **前提条件**: rotate_count=3
- **実行**: 4つ目のローテーション
- **期待結果**: 最も古いファイルが削除される
- **検証項目**: ファイル数が3個に保たれる

### 7. エラー処理テスト

#### TC-016: ファイル書き込みエラー
- **前提条件**: 書き込み権限のないディレクトリ
- **実行**: ファイル出力を試行
- **期待結果**: 
  - エラーがログに記録される
  - アプリケーションは継続動作
- **検証項目**:
  - 例外が発生しない
  - コンソール出力は継続

#### TC-017: 不正なログレベル
- **前提条件**: 存在しないレベル名を設定
- **実行**: set_level('INVALID')
- **期待結果**: デフォルトレベル（INFO）が使用される
- **検証項目**: 警告が出力される

#### TC-018: 不正なフォーマット文字列
- **前提条件**: 不正なフォーマット文字列
- **実行**: ログ出力
- **期待結果**: デフォルトフォーマットで出力
- **検証項目**: クラッシュしない

### 8. カラー出力テスト

#### TC-019: レベル別カラー出力
- **前提条件**: カラー出力が有効（TTY環境）
- **実行**: 各レベルでログ出力
- **期待結果**: レベルに応じた色で表示
- **検証項目**:
  - DEBUG: シアン
  - INFO: 緑
  - WARNING: 黄
  - ERROR: 赤
  - CRITICAL: マゼンタ

#### TC-020: 非TTY環境でのカラー無効化
- **前提条件**: パイプ経由など非TTY環境
- **実行**: ログ出力
- **期待結果**: カラーコードが含まれない
- **検証項目**: プレーンテキストで出力

### 9. パフォーマンステスト

#### TC-021: ログ出力のレイテンシ
- **前提条件**: 通常の設定
- **実行**: 1000回のログ出力
- **期待結果**: 平均1ms以内
- **検証項目**: 処理時間の測定

#### TC-022: メモリ使用量
- **前提条件**: 長時間実行
- **実行**: 10000回のログ出力
- **期待結果**: メモリ使用量5MB以内
- **検証項目**: メモリプロファイリング

### 10. 統合テスト

#### TC-023: ConfigManagerとの連携
- **前提条件**: ConfigManagerから設定読み込み
- **実行**: LogManagerを初期化
- **期待結果**: 設定が正しく適用される
- **検証項目**:
  - 設定ファイルのログレベルが反映
  - モジュール別設定が適用
  - 出力先設定が反映

#### TC-024: スレッドセーフティ
- **前提条件**: マルチスレッド環境
- **実行**: 複数スレッドから同時ログ出力
- **期待結果**: 
  - ログが混在しない
  - デッドロックが発生しない
- **検証項目**: 出力の整合性確認